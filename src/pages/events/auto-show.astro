---
import "../../styles/global.css";
import AutoCard from "../../components/AutoCard.astro";

const events = [
  { title: "Robo Wars", image: "/robot.jpeg", accent: "#ff004c" },
  { title: "Hackathon", image: "/hack.jpg", accent: "#00f2ff" },
  { title: "Drone Race", image: "/drone.jpg", accent: "#bc00ff" },
  { title: "Cyber Security", image: "/cyber.jpg", accent: "#39ff14" },
  { title: "AI Summit", image: "/ai.jpg", accent: "#f4ff00" },
];

// We double the array to ensure seamless looping visually before GSAP takes over
const loopEvents = [...events, ...events];
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tech Events & Competitions</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;900&family=Inter:wght@300;400&display=swap" rel="stylesheet" />
    
    <style>
      :root {
        --bg-color: #040503;
        --accent-cyan: #00f2ff;
      }

      body {
        font-family: 'Inter', sans-serif;
        background-color: #040503;
        background-image: url("/autoshow_tex.png");
        color: white;
        overflow-x: hidden;
      }

      .font-orbitron { font-family: 'Orbitron', sans-serif; }

      /* Masking the edges for a cinematic feel */
      .slider-container {
        mask-image: linear-gradient(to right, transparent, black 15%, black 85%, transparent);
        -webkit-mask-image: linear-gradient(to right, transparent, black 15%, black 85%, transparent);
      }

      .glass-card {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
    </style>
  </head>
  
  <body class="min-h-screen flex flex-col justify-center overflow-hidden">
    
    <div class="container mx-auto px-10 mb-8 relative z-20">
      <div class="flex flex-col md:flex-row md:items-end justify-between gap-6">
        <div>
          <h2 class="text-xs tracking-[0.5em] text-cyan-400 font-bold uppercase mb-2">2026 Innovation Circuit</h2>
          <h1 class="text-5xl md:text-7xl font-black uppercase font-orbitron tracking-tighter italic">
            TECH <span class="text-white opacity-50">EVENTS</span>
          </h1>
        </div>
        <p class="text-gray-400 max-w-sm text-sm leading-relaxed border-l border-cyan-500/50 pl-4">
          Witness the collision of steel and code. The arena where future-tech is forged in real-time.
        </p>
      </div>
    </div>

    <div class="slider-container relative w-full py-10">
      <div id="track" class="flex gap-8 whitespace-nowrap will-change-transform cursor-grab active:cursor-grabbing">
        {loopEvents.map((event) => (
          <div class="card-wrapper shrink-0 w-[350px] md:w-[450px]">
            <AutoCard 
              title={event.title} 
              image={event.image} 
              accent={event.accent} 
            />
          </div>
        ))}
      </div>
    </div>

    <div class="flex justify-center items-center gap-12 mt-4">
        <button id="prevBtn" class="group flex items-center gap-3 text-xs tracking-widest uppercase font-bold text-gray-500 hover:text-cyan-400 transition-all">
          <span class="h-[1px] w-8 bg-gray-700 group-hover:bg-cyan-400 transition-all"></span> PREV
        </button>
        <div class="h-12 w-[1px] bg-white/10 rotate-12"></div>
        <button id="nextBtn" class="group flex items-center gap-3 text-xs tracking-widest uppercase font-bold text-gray-500 hover:text-cyan-400 transition-all">
          NEXT <span class="h-[1px] w-8 bg-gray-700 group-hover:bg-cyan-400 transition-all"></span>
        </button>
    </div>
<script>
  // Import GSAP and Draggable directly
  import { gsap } from "gsap";
  import { Draggable } from "gsap/Draggable";

  // Register the plugin
  gsap.registerPlugin(Draggable);

  document.addEventListener('DOMContentLoaded', () => {
    const track = document.querySelector('#track');
    // Ensure track exists before running logic
    if (!track) return;

    const cards = gsap.utils.toArray('.card-wrapper');
    const loopWidth = track.scrollWidth / 2;

    const animation = gsap.to(track, {
      x: `-=${loopWidth}`,
      duration: 30,
      ease: "none",
      repeat: -1,
      modifiers: {
        x: gsap.utils.unitize(x => parseFloat(x) % loopWidth)
      }
    });

    // Hover Interactions
    track.addEventListener('mouseenter', () => gsap.to(animation, {timeScale: 0.0, duration: 0.8}));
    track.addEventListener('mouseleave', () => gsap.to(animation, {timeScale: 1, duration: 0.8}));

    // Button Logic
    document.getElementById('nextBtn')?.addEventListener('click', () => {
      gsap.to(track, {
        x: "-=400", 
        duration: 0.5, 
        ease: "power2.out",
        onUpdate: () => {
          const currentX = gsap.getProperty(track, "x");
          if (Math.abs(currentX) >= loopWidth) {
            gsap.set(track, {x: 0});
          }
        }
      });
    });

    document.getElementById('prevBtn')?.addEventListener('click', () => {
      gsap.to(track, {
        x: "+=400", 
        duration: 0.5, 
        ease: "power2.out"
      });
    });
  });
</script>

    
  </body>
</html>
