---
import "../../styles/global.css";
import FoodCard from "../../components/FoodCard.astro";
import { supabase } from "../../lib/supabase";

const { data: foodfest, error } = await supabase
  .from("foodfest")
  .select("title, tag, image, type")
  .order("created_at", { ascending: true });

if (error) {
  throw new Error(error.message);
}

const events = foodfest.filter(item => item.type === "event");
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Food Fest</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Orbitron", sans-serif;
        background-color: #24050e;
        background-image: url("/foodshow_tex.png");
      }

      .section-heading {
        text-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
      }
    </style>
  </head>

  <body>
    <div class="min-h-screen px-6 py-12 md:p-16 lg:p-24 max-w-7xl mx-auto">

      <!-- EVENTS -->
      <section class="mb-20">
        <h1 class="section-heading text-white text-3xl md:text-5xl font-black uppercase tracking-[0.2em] mb-4">
          Events
        </h1>

        <div class="w-24 h-[3px] bg-cyan-400 mb-12"></div>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10">
          {events.map(event => (
            <FoodCard
              title={event.title}
              tag={event.tag}
              image={event.image}
            />
          ))}
        </div>
      </section>

      <!-- COMPETITIONS -->
      <section>
        <h1 class="section-heading text-white text-3xl md:text-5xl font-black uppercase tracking-[0.2em] mb-4">
          Competitions
        </h1>

        <div class="w-24 h-[3px] bg-pink-500 mb-12"></div>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10">
          <!--  {competitions.map(comp => (
            <FoodCard
              title={comp.title}
              tag={comp.tag}
              image={comp.image}
            />
            ))} -->
        </div>
      </section>

    </div>
  </body>
</html>

